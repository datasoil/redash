{"version":3,"sources":["../../src/components/ErrorBoundary.tsx"],"names":["logger","ErrorBoundaryContext","React","createContext","handleError","error","setTimeout","reset","ErrorMessage","children","defaultProps","ErrorBoundary","Component","setState","constructor","getDerivedStateFromError","componentDidCatch","window","handleException","errorInfo","render","props","renderError","state"],"mappings":";;;;;;;;AAAA;;AACA;;AACA;;AACA;;;;;;AAEA,IAAMA,MAAM,GAAG,oBAAM,eAAN,CAAf;;AAEO,IAAMC,oBAAoB,GAAGC,eAAMC,aAAN,CAAoB;AACtDC,EAAAA,WAAW,EAAGC,KAAD,IAAgB;AAC3B;AACAC,IAAAA,UAAU,CAAC,MAAM;AACf,YAAMD,KAAN;AACD,KAFS,CAAV;AAGD,GANqD;AAOtDE,EAAAA,KAAK,EAAE,MAAM,CAAE;AAPuC,CAApB,CAA7B;;;;AAgBA,SAASC,YAAT,OAAuD;AAAA,MAA/BC,QAA+B,QAA/BA,QAA+B;AAC5D,sBAAO,6BAAC,cAAD;AAAO,IAAA,OAAO,EAAEA,QAAhB;AAA0B,IAAA,IAAI,EAAC,OAA/B;AAAuC,IAAA,QAAQ;AAA/C,IAAP;AACD;;AAEDD,YAAY,CAACE,YAAb,GAA4B;AAC1BD,EAAAA,QAAQ,EAAE;AADgB,CAA5B;;AAYe,MAAME,aAAN,SAA4BT,eAAMU,SAAlC,CAAoF;AAAA;AAAA;;AAAA,mCAMzF;AAAEP,MAAAA,KAAK,EAAE;AAAT,KANyF;;AAAA,yCAQlFA,KAAD,IAAgB;AAC5B;AACA,WAAKQ,QAAL,CAAc,KAAKC,WAAL,CAAiBC,wBAAjB,CAA0CV,KAA1C,CAAd;AACA,WAAKW,iBAAL,CAAuBX,KAAvB,EAA8B,IAA9B,EAH4B,CAI5B;;AACA,UAAI,wBAAWY,MAAM,CAACC,eAAlB,CAAJ,EAAwC;AACtC;AACAD,QAAAA,MAAM,CAACC,eAAP,CAAuBb,KAAvB;AACD;AACF,KAjBgG;;AAAA,mCAmBzF,MAAM;AACZ,WAAKQ,QAAL,CAAc;AAAER,QAAAA,KAAK,EAAE;AAAT,OAAd;AACD,KArBgG;AAAA;;AAuBjG,SAAOU,wBAAP,CAAgCV,KAAhC,EAA4C;AAC1C,WAAO;AAAEA,MAAAA;AAAF,KAAP;AACD;;AAEDW,EAAAA,iBAAiB,CAACX,KAAD,EAAac,SAAb,EAA6B;AAC5CnB,IAAAA,MAAM,CAACK,KAAD,EAAQc,SAAR,CAAN;AACD;;AAEDC,EAAAA,MAAM,GAAG;AAAA,sBAC2B,KAAKC,KADhC;AAAA,QACCC,WADD,eACCA,WADD;AAAA,QACcb,QADd,eACcA,QADd;AAAA,QAECJ,KAFD,GAEW,KAAKkB,KAFhB,CAEClB,KAFD;;AAIP,QAAIA,KAAJ,EAAW;AACT,UAAI,wBAAWiB,WAAX,CAAJ,EAA6B;AAC3B;AACA,eAAOA,WAAW,CAACjB,KAAD,CAAlB;AACD;;AACD,0BAAO,6BAAC,YAAD,OAAP;AACD;;AAED,wBAAO,6BAAC,oBAAD,CAAsB,QAAtB;AAA+B,MAAA,KAAK,EAAE;AAAtC,OAA6CI,QAA7C,CAAP;AACD;;AA5CgG;;;;gBAA9EE,a,kBACG;AACpBF,EAAAA,QAAQ,EAAE,IADU;AAEpBa,EAAAA,WAAW,EAAE;AAFO,C","sourcesContent":["import { isFunction } from \"lodash\";\nimport React from \"react\";\nimport debug from \"debug\";\nimport Alert from \"antd/lib/alert\";\n\nconst logger = debug(\"redash:errors\");\n\nexport const ErrorBoundaryContext = React.createContext({\n  handleError: (error: any) => {\n    // Allow calling chain to roll up, and then throw the error in global context\n    setTimeout(() => {\n      throw error;\n    });\n  },\n  reset: () => {},\n});\n\ntype OwnErrorMessageProps = {\n  children?: React.ReactNode;\n};\n\ntype ErrorMessageProps = OwnErrorMessageProps & typeof ErrorMessage.defaultProps;\n\nexport function ErrorMessage({ children }: ErrorMessageProps) {\n  return <Alert message={children} type=\"error\" showIcon />;\n}\n\nErrorMessage.defaultProps = {\n  children: \"Something went wrong.\",\n};\n\ntype OwnErrorBoundaryProps = {\n  renderError?: (...args: any[]) => any;\n};\n\ntype ErrorBoundaryState = any;\n\ntype ErrorBoundaryProps = OwnErrorBoundaryProps & typeof ErrorBoundary.defaultProps;\n\nexport default class ErrorBoundary extends React.Component<ErrorBoundaryProps, ErrorBoundaryState> {\n  static defaultProps = {\n    children: null,\n    renderError: null,\n  };\n\n  state = { error: null };\n\n  handleError = (error: any) => {\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'getDerivedStateFromError' does not exist... Remove this comment to see the full error message\n    this.setState(this.constructor.getDerivedStateFromError(error));\n    this.componentDidCatch(error, null);\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'handleException' does not exist on type ... Remove this comment to see the full error message\n    if (isFunction(window.handleException)) {\n      // @ts-expect-error ts-migrate(2339) FIXME: Property 'handleException' does not exist on type ... Remove this comment to see the full error message\n      window.handleException(error);\n    }\n  };\n\n  reset = () => {\n    this.setState({ error: null });\n  };\n\n  static getDerivedStateFromError(error: any) {\n    return { error };\n  }\n\n  componentDidCatch(error: any, errorInfo: any) {\n    logger(error, errorInfo);\n  }\n\n  render() {\n    const { renderError, children } = this.props;\n    const { error } = this.state;\n\n    if (error) {\n      if (isFunction(renderError)) {\n        // @ts-expect-error ts-migrate(2349) FIXME: This expression is not callable.\n        return renderError(error);\n      }\n      return <ErrorMessage />;\n    }\n\n    return <ErrorBoundaryContext.Provider value={this}>{children}</ErrorBoundaryContext.Provider>;\n  }\n}\n"],"file":"ErrorBoundary.js"}