{"version":3,"sources":["../../../../src/visualizations/table/columns/image.tsx"],"names":["Editor","column","onChange","onChangeDebounced","imageUrlTemplate","event","target","value","marginBottom","imageWidth","imageHeight","imageTitleTemplate","cursor","ContextHelp","defaultIcon","initImageColumn","prepareData","row","name","src","width","parseInt","height","title","result","Number","isFinite","text","alt","ImageColumn","props","friendlyName"],"mappings":"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","sourcesContent":["import { extend, trim } from \"lodash\";\nimport React from \"react\";\nimport { useDebouncedCallback } from \"use-debounce\";\nimport { Section, Input, ControlLabel, ContextHelp } from \"@/components/visualizations/editor\";\nimport { formatSimpleTemplate } from \"@/lib/value-format\";\n\ntype Props = {\n  column: {\n    name: string;\n    imageUrlTemplate?: string;\n    imageWidth?: string;\n    imageHeight?: string;\n    imageTitleTemplate?: string;\n  };\n  onChange: (...args: any[]) => any;\n};\n\nfunction Editor({ column, onChange }: Props) {\n  const [onChangeDebounced] = useDebouncedCallback(onChange, 200);\n\n  return (\n    <React.Fragment>\n      {/* @ts-expect-error ts-migrate(2745) FIXME: This JSX tag's 'children' prop expects type 'never... Remove this comment to see the full error message */}\n      <Section>\n        <Input\n          label=\"URL template\"\n          data-test=\"Table.ColumnEditor.Image.UrlTemplate\"\n          defaultValue={column.imageUrlTemplate}\n          onChange={(event: any) => onChangeDebounced({ imageUrlTemplate: event.target.value })}\n        />\n      </Section>\n\n      {/* @ts-expect-error ts-migrate(2745) FIXME: This JSX tag's 'children' prop expects type 'never... Remove this comment to see the full error message */}\n      <Section>\n        <ControlLabel\n          // @ts-expect-error ts-migrate(2322) FIXME: Type 'Element' is not assignable to type 'null | u... Remove this comment to see the full error message\n          label={\n            <React.Fragment>\n              Size\n              {/* @ts-expect-error ts-migrate(2746) FIXME: This JSX tag's 'children' prop expects a single ch... Remove this comment to see the full error message */}\n              <ContextHelp placement=\"topLeft\" arrowPointAtCenter>\n                <div style={{ marginBottom: 5 }}>Any positive integer value that specifies size in pixels.</div>\n                <div>Leave empty to use default value.</div>\n              </ContextHelp>\n            </React.Fragment>\n          }>\n          {/* @ts-expect-error ts-migrate(2322) FIXME: Type 'Element' is not assignable to type 'null | u... Remove this comment to see the full error message */}\n          <div className=\"image-dimension-selector\">\n            <Input\n              data-test=\"Table.ColumnEditor.Image.Width\"\n              placeholder=\"Width\"\n              defaultValue={column.imageWidth}\n              onChange={(event: any) => onChangeDebounced({ imageWidth: event.target.value })}\n            />\n            <span className=\"image-dimension-selector-spacer\">&times;</span>\n            <Input\n              data-test=\"Table.ColumnEditor.Image.Height\"\n              placeholder=\"Height\"\n              defaultValue={column.imageHeight}\n              onChange={(event: any) => onChangeDebounced({ imageHeight: event.target.value })}\n            />\n          </div>\n        </ControlLabel>\n      </Section>\n\n      {/* @ts-expect-error ts-migrate(2745) FIXME: This JSX tag's 'children' prop expects type 'never... Remove this comment to see the full error message */}\n      <Section>\n        <Input\n          label=\"Title template\"\n          data-test=\"Table.ColumnEditor.Image.TitleTemplate\"\n          defaultValue={column.imageTitleTemplate}\n          onChange={(event: any) => onChangeDebounced({ imageTitleTemplate: event.target.value })}\n        />\n      </Section>\n\n      {/* @ts-expect-error ts-migrate(2745) FIXME: This JSX tag's 'children' prop expects type 'never... Remove this comment to see the full error message */}\n      <Section>\n        {/* @ts-expect-error ts-migrate(2746) FIXME: This JSX tag's 'children' prop expects a single ch... Remove this comment to see the full error message */}\n        <ContextHelp\n          placement=\"topLeft\"\n          arrowPointAtCenter\n          // @ts-expect-error ts-migrate(2322) FIXME: Type 'Element' is not assignable to type 'null | u... Remove this comment to see the full error message\n          icon={<span style={{ cursor: \"default\" }}>Format specs {ContextHelp.defaultIcon}</span>}>\n          <div>\n            All columns can be referenced using <code>{\"{{ column_name }}\"}</code> syntax.\n          </div>\n          <div>\n            Use <code>{\"{{ @ }}\"}</code> to reference current (this) column.\n          </div>\n          <div>This syntax is applicable to URL, Title and Size options.</div>\n        </ContextHelp>\n      </Section>\n    </React.Fragment>\n  );\n}\n\nexport default function initImageColumn(column: any) {\n  function prepareData(row: any) {\n    row = extend({ \"@\": row[column.name] }, row);\n\n    const src = trim(formatSimpleTemplate(column.imageUrlTemplate, row));\n    if (src === \"\") {\n      return {};\n    }\n\n    const width = parseInt(formatSimpleTemplate(column.imageWidth, row), 10);\n    const height = parseInt(formatSimpleTemplate(column.imageHeight, row), 10);\n    const title = trim(formatSimpleTemplate(column.imageTitleTemplate, row));\n\n    const result = { src };\n\n    if (Number.isFinite(width) && width > 0) {\n      // @ts-expect-error ts-migrate(2339) FIXME: Property 'width' does not exist on type '{ src: st... Remove this comment to see the full error message\n      result.width = width;\n    }\n    if (Number.isFinite(height) && height > 0) {\n      // @ts-expect-error ts-migrate(2339) FIXME: Property 'height' does not exist on type '{ src: s... Remove this comment to see the full error message\n      result.height = height;\n    }\n    if (title !== \"\") {\n      // @ts-expect-error ts-migrate(2339) FIXME: Property 'text' does not exist on type '{ src: str... Remove this comment to see the full error message\n      result.text = title; // `text` is used for search\n      // @ts-expect-error ts-migrate(2339) FIXME: Property 'title' does not exist on type '{ src: st... Remove this comment to see the full error message\n      result.title = title;\n      // @ts-expect-error ts-migrate(2339) FIXME: Property 'alt' does not exist on type '{ src: stri... Remove this comment to see the full error message\n      result.alt = title;\n    }\n\n    return result;\n  }\n\n  function ImageColumn({ row }: any) {\n    // @ts-expect-error ts-migrate(2339) FIXME: Property 'text' does not exist on type '{}'.\n    // eslint-disable-line react/prop-types\n    const { text, ...props } = prepareData(row);\n    return <img alt=\"\" {...props} />;\n  }\n\n  ImageColumn.prepareData = prepareData;\n\n  return ImageColumn;\n}\n\ninitImageColumn.friendlyName = \"Image\";\ninitImageColumn.Editor = Editor;\n"],"file":"image.js"}