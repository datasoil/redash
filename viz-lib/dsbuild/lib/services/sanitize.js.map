{"version":3,"sources":["../../src/services/sanitize.ts"],"names":["DOMPurify","setConfig","ADD_ATTR","addHook","node","target","getAttribute","toLowerCase","setAttribute","removeAttribute","sanitize"],"mappings":";;;;;;;;;;;;;AAAA;;AACA;;;;AAEAA,mBAAUC,SAAV,CAAoB;AAClBC,EAAAA,QAAQ,EAAE,CAAC,QAAD;AADQ,CAApB;;AAIAF,mBAAUG,OAAV,CAAkB,yBAAlB,EAA6C,UAASC,IAAT,EAAe;AAC1D;AACA;AACA;AAEA,MAAMC,MAAM,GAAGD,IAAI,CAACE,YAAL,CAAkB,QAAlB,CAAf;;AACA,MAAI,sBAASD,MAAT,KAAoBA,MAAM,CAACE,WAAP,OAAyB,QAAjD,EAA2D;AACzDH,IAAAA,IAAI,CAACI,YAAL,CAAkB,KAAlB,EAAyB,qBAAzB;AACD,GAFD,MAEO;AACLJ,IAAAA,IAAI,CAACK,eAAL,CAAqB,QAArB;AACD;AACF,CAXD;;eAeeT,mBAAUU,Q","sourcesContent":["import { isString } from \"lodash\";\nimport DOMPurify from \"dompurify\";\n\nDOMPurify.setConfig({\n  ADD_ATTR: [\"target\"],\n});\n\nDOMPurify.addHook(\"afterSanitizeAttributes\", function(node) {\n  // Fix elements with `target` attribute:\n  // - allow only `target=\"_blank\"\n  // - add `rel=\"noopener noreferrer\"` to prevent https://www.owasp.org/index.php/Reverse_Tabnabbing\n\n  const target = node.getAttribute(\"target\");\n  if (isString(target) && target.toLowerCase() === \"_blank\") {\n    node.setAttribute(\"rel\", \"noopener noreferrer\");\n  } else {\n    node.removeAttribute(\"target\");\n  }\n});\n\nexport { DOMPurify };\n\nexport default DOMPurify.sanitize;\n"],"file":"sanitize.js"}